{% extends 'layout.html' %}
{% load staticfiles %}
{% block title %}{{ room_name }}{% endblock %}
{% block contents %}

        {% if not is_active %}
            <h3 class="text-center">Sorry this room is not active</h3>
        {% elif not has_access %}
            <h3 class="text-center">You have no permission in this room</h3>
        {% endif %}

        {% if is_active and has_access %}

            <div class="row">
                <div class="col-md-12">
                    <div id="meet"></div>
                </div>

            </div>

        <script src='https://talk.gomeeting.org/libs/external_api.min.js'></script>
        <script type="text/javascript">
            const domain = '{{ domain }}';
            const options = {
                roomName: '{{ room_obj.room_id }}',
                width: '100%',
                height: 700,
                parentNode: document.querySelector('#meet'),
                jwt: '{{ token }}'

            };
            const api = new JitsiMeetExternalAPI(domain, options);
            api.executeCommand('displayName', '{{ user.profile.name }}');

            api.executeCommand('subject', '{{ room_obj.name }}');

            api.addEventListener('videoConferenceLeft', function () {
                window.location = "{% url 'room:room_list' %}";
            });

        </script>
        {% endif %}
{% endblock %}